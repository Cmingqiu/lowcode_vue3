{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue","webpack:///./src/packages/editor-block.jsx","webpack:///./src/utils/event.js","webpack:///./src/utils/drag.js","webpack:///./src/utils/useFocus.js","webpack:///./src/utils/useBlockDrag.js","webpack:///./src/utils/useCommand.js","webpack:///./src/components/Dialog.jsx","webpack:///./src/components/Dropdown.jsx","webpack:///./src/packages/editor-operator.jsx","webpack:///./src/packages/editor.jsx","webpack:///./src/components/Range.jsx","webpack:///./src/utils/editor-config.js","webpack:///./src/App.vue?889f","webpack:///./src/main.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","source","formData","defineComponent","props","block","setup","config","inject","blockRef","ref","blockStyle","computed","top","left","zIndex","onMounted","offsetWidth","offsetHeight","alignCenter","width","height","component","componentMap","renderComponent","render","model","keys","reduce","prev","modelName","modelValue","v","events","mitt","useDrag","containerRef","currentComponent","dragstart","e","addEventListener","dragenter","dragover","drop","dragleave","emit","dataTransfer","dropEffect","preventDefault","blocks","offsetX","offsetY","default","start","end","target","dragend","removeEventListener","useFocus","isPreview","cb","selectIndex","lastSelectBlock","focusData","focused","unfocused","forEach","focus","blockMouseDown","index","stopPropagation","ctrlKey","clearBlockFocus","useBlockDrag","dragState","startX","startY","dragging","markLine","reactive","x","y","blockDrag","BWidth","BHeight","startLeft","startTop","clientX","clientY","startPos","map","lines","container","ALeft","ATop","AWidth","AHeight","showTop","showLeft","document","mousemove","mouseup","Math","abs","durX","durY","idx","useCommand","state","current","queue","commands","commandsArray","destroyArray","register","command","execute","redo","undo","pushQueue","keyboard","item","init","this","before","deepcopy","drag","on","off","after","newVal","oldBlock","indexOf","maxZIndex","max","Infinity","minZIndex","min","dur","keyboardEvent","keyCodes","89","90","onkeydown","keyCode","keyString","join","onUnmounted","fn","vm","DialogComponent","option","ctx","isShow","expose","showDialog","onCancel","onConfirm","confirm","content","title","footer","$dialog","el","createElement","createVNode","body","appendChild","exposed","DropdownItem","label","type","String","required","icon","handler","Function","hide","DropdownComponent","dropdownRef","show","style","showDropdown","provide","onMouseDown","contains","onBeforeUnmount","$dropdown","updateContainer","updateBlock","editData","reset","watch","immediate","entries","propName","propConfig","input","color","select","options","emits","components","EditorBlock","editorRef","set","val","contentStyle","onContextMenuBlock","placeTop","placeBottom","JSON","stringify","text","parse","delete","buttons","class","handle","btn","className","componentList","preview","Number","createEditorConfig","registerConfig","createInputProp","createColorProp","createSelectProp","fontSize","size","Editor","username","__exports__","createApp","App","mount"],"mappings":"aACE,SAASA,EAAqBC,GAQ7B,IAPA,IAMIC,EAAUC,EANVC,EAAWH,EAAK,GAChBI,EAAcJ,EAAK,GACnBK,EAAiBL,EAAK,GAIHM,EAAI,EAAGC,EAAW,GACpCD,EAAIH,EAASK,OAAQF,IACzBJ,EAAUC,EAASG,GAChBG,OAAOC,UAAUC,eAAeC,KAAKC,EAAiBX,IAAYW,EAAgBX,IACpFK,EAASO,KAAKD,EAAgBX,GAAS,IAExCW,EAAgBX,GAAW,EAE5B,IAAID,KAAYG,EACZK,OAAOC,UAAUC,eAAeC,KAAKR,EAAaH,KACpDc,EAAQd,GAAYG,EAAYH,IAG/Be,GAAqBA,EAAoBhB,GAE5C,MAAMO,EAASC,OACdD,EAASU,OAATV,GAOD,OAHAW,EAAgBJ,KAAKK,MAAMD,EAAiBb,GAAkB,IAGvDe,IAER,SAASA,IAER,IADA,IAAIC,EACIf,EAAI,EAAGA,EAAIY,EAAgBV,OAAQF,IAAK,CAG/C,IAFA,IAAIgB,EAAiBJ,EAAgBZ,GACjCiB,GAAY,EACRC,EAAI,EAAGA,EAAIF,EAAed,OAAQgB,IAAK,CAC9C,IAAIC,EAAQH,EAAeE,GACG,IAA3BX,EAAgBY,KAAcF,GAAY,GAE3CA,IACFL,EAAgBQ,OAAOpB,IAAK,GAC5Be,EAASM,EAAoBA,EAAoBC,EAAIN,EAAe,KAItE,OAAOD,EAIR,IAAIQ,EAAmB,GAKnBhB,EAAkB,CACrB,IAAO,GAGJK,EAAkB,GAGtB,SAASS,EAAoB1B,GAG5B,GAAG4B,EAAiB5B,GACnB,OAAO4B,EAAiB5B,GAAU6B,QAGnC,IAAIC,EAASF,EAAiB5B,GAAY,CACzCK,EAAGL,EACH+B,GAAG,EACHF,QAAS,IAUV,OANAf,EAAQd,GAAUW,KAAKmB,EAAOD,QAASC,EAAQA,EAAOD,QAASH,GAG/DI,EAAOC,GAAI,EAGJD,EAAOD,QAKfH,EAAoBM,EAAIlB,EAGxBY,EAAoBO,EAAIL,EAGxBF,EAAoBQ,EAAI,SAASL,EAASM,EAAMC,GAC3CV,EAAoBW,EAAER,EAASM,IAClC3B,OAAO8B,eAAeT,EAASM,EAAM,CAAEI,YAAY,EAAMC,IAAKJ,KAKhEV,EAAoBe,EAAI,SAASZ,GACX,qBAAXa,QAA0BA,OAAOC,aAC1CnC,OAAO8B,eAAeT,EAASa,OAAOC,YAAa,CAAEC,MAAO,WAE7DpC,OAAO8B,eAAeT,EAAS,aAAc,CAAEe,OAAO,KAQvDlB,EAAoBmB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQlB,EAAoBkB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,kBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKxC,OAAOyC,OAAO,MAGvB,GAFAvB,EAAoBe,EAAEO,GACtBxC,OAAO8B,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOlB,EAAoBQ,EAAEc,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRtB,EAAoB0B,EAAI,SAAStB,GAChC,IAAIM,EAASN,GAAUA,EAAOiB,WAC7B,WAAwB,OAAOjB,EAAO,YACtC,WAA8B,OAAOA,GAEtC,OADAJ,EAAoBQ,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRV,EAAoBW,EAAI,SAASgB,EAAQC,GAAY,OAAO9C,OAAOC,UAAUC,eAAeC,KAAK0C,EAAQC,IAGzG5B,EAAoB6B,EAAI,iBAExB,IAAIC,EAAaC,OAAO,gBAAkBA,OAAO,iBAAmB,GAChEC,EAAmBF,EAAW3C,KAAKsC,KAAKK,GAC5CA,EAAW3C,KAAOf,EAClB0D,EAAaA,EAAWG,QACxB,IAAI,IAAItD,EAAI,EAAGA,EAAImD,EAAWjD,OAAQF,IAAKP,EAAqB0D,EAAWnD,IAC3E,IAAIU,EAAsB2C,EAI1BzC,EAAgBJ,KAAK,CAAC,EAAE,kBAEjBM,K,2NCtJP,eAAgD,G,WAA/B,EAAAyC,O,qDAAA,EAAAA,OAAM,IAAGC,SAAU,EAAAA,U,mFCAvBC,G,UAAAA,eAAgB,CAC7BC,MAAO,CACLC,MAAOxD,OACPqD,SAAUrD,QAEZyD,MAL6B,SAKvBF,GACJ,IAAMG,EAASC,eAAO,UAChBC,EAAWC,eAAI,MACfC,EAAaC,gBAAS,iBAAO,CACjCC,IAAK,GAAF,OAAKT,EAAMC,MAAMQ,IAAjB,MACHC,KAAM,GAAF,OAAKV,EAAMC,MAAMS,KAAjB,MACJC,OAAQX,EAAMC,MAAMU,WAgBtB,OAbAC,gBAAU,WAER,MAAsCP,EAASxB,MAAvCgC,EAAR,EAAQA,YAAaC,EAArB,EAAqBA,aACjBd,EAAMC,MAAMc,cACdf,EAAMC,MAAMS,MAAQG,EAAc,EAClCb,EAAMC,MAAMQ,KAAOK,EAAe,EAClCd,EAAMC,MAAMc,aAAc,GAG5Bf,EAAMC,MAAMe,MAAQH,EACpBb,EAAMC,MAAMgB,OAASH,KAGhB,WACL,IAAMI,EAAYf,EAAOgB,aAAanB,EAAMC,MAAMd,KAG5CiC,EAAkBF,EAAUG,OAAO,CACvCrB,MAAOA,EAAMC,MAAMD,MACnBsB,MAAO7E,OAAO8E,KAAKL,EAAUI,OAAS,IAAIE,QAAO,SAACC,EAAMC,GAMtD,OALAD,EAAKC,GAAa,CAChBC,WAAY3B,EAAMF,SAASE,EAAMC,MAAMqB,MAAMI,IAC7C,sBAAuB,SAAAE,GAAC,OACrB5B,EAAMF,SAASE,EAAMC,MAAMqB,MAAMI,IAAcE,IAE7CH,IACN,MAGL,mCACa,eADb,IACiCpB,EADjC,MACkDE,EAAW1B,OAD7D,CAEKuC,S,gDC5CLS,EAASC,iBACAD,ICDA,SAASE,EAAQC,EAAchG,GAC5C,IAAIiG,EAAmB,KAEjBC,EAAY,SAACC,EAAGjB,GACpBe,EAAmBf,EACnBc,EAAanD,MAAMuD,iBAAiB,YAAaC,GACjDL,EAAanD,MAAMuD,iBAAiB,WAAYE,GAChDN,EAAanD,MAAMuD,iBAAiB,OAAQG,GAC5CP,EAAanD,MAAMuD,iBAAiB,YAAaI,GACjDX,EAAOY,KAAK,UAIRJ,EAAY,SAAAF,GAChBA,EAAEO,aAAaC,WAAa,QAIxBL,EAAW,SAAAH,GACfA,EAAES,kBAIEL,EAAO,SAAAJ,GACX,IAAMU,EAAW7G,EAAK6C,MAAhBgE,OACN7G,EAAK6C,MAAL,iCACK7C,EAAK6C,OADV,IAEEgE,OAAQ,GAAF,sBACDA,GADC,CAEJ,CACEnC,KAAMyB,EAAEW,QACRrC,IAAK0B,EAAEY,QACPpC,OAAQ,EACRxB,IAAK8C,EAAiB9C,IACtB4B,aAAa,EACbf,MAAO,GACPsB,MAAO,CACL0B,QAAS,WACTC,MAAO,QACPC,IAAK,YAKbjB,EAAmB,MAIfO,EAAY,SAACL,EAAGgB,GACpBhB,EAAEO,aAAaC,WAAa,QAIxBS,EAAU,SAAAjB,GACdH,EAAanD,MAAMwE,oBAAoB,YAAahB,GACpDL,EAAanD,MAAMwE,oBAAoB,WAAYf,GACnDN,EAAanD,MAAMwE,oBAAoB,OAAQd,GAC/CP,EAAanD,MAAMwE,oBAAoB,YAAab,GACpDX,EAAOY,KAAK,QAGd,MAAO,CACLP,YACAkB,W,UC/DW,SAASE,EAAStH,EAAMuH,EAAWC,GAChD,IAAIC,EAAcnD,gBAAK,GAEjBoD,EAAkBlD,gBAAS,kBAAMxE,EAAK6C,MAAMgE,OAAOY,EAAY5E,UAE/D8E,EAAYnD,gBAAS,WACzB,IAAIoD,EAAU,GACZC,EAAY,GAId,OAHA7H,EAAK6C,MAAMgE,OAAOiB,SAAQ,SAAA7D,GAAK,OAC5BA,EAAM8D,MAAQH,EAAUC,GAAW/G,KAAKmD,MAEpC,CAAE2D,UAASC,gBAIdG,EAAiB,SAAC7B,EAAGlC,EAAOgE,GAC5BV,EAAU1E,QACdsD,EAAES,iBACFT,EAAE+B,kBAEGjE,EAAM8D,QACJ5B,EAAEgC,SAASC,IAChBnE,EAAM8D,OAAQ,GAIhBN,EAAY5E,MAAQoF,EACpBT,GAAMA,EAAGrB,KAILiC,EAAkB,WACtBX,EAAY5E,OAAS,EACrB7C,EAAK6C,MAAMgE,OAAOiB,SAAQ,SAAA7D,GAAK,OAAKA,EAAM8D,OAAQ,MAGpD,MAAO,CACLJ,YACAK,iBACAI,kBACAV,mBCvCW,SAASW,EAAaV,EAAWD,EAAiB1H,GAC/D,IAAIsI,EAAY,CACdC,OAAQ,EACRC,OAAQ,EACRC,UAAU,GAERC,EAAWC,eAAS,CAAEC,EAAG,KAAMC,EAAG,OAGhCC,EAAY,SAAA3C,GAChB,MAKIuB,EAAgB7E,MAJXkG,EADT,EACE/D,MACQgE,EAFV,EAEE/D,OACMgE,EAHR,EAGEvE,KACKwE,EAJP,EAIEzE,IAGF6D,EAAY,CACVC,OAAQpC,EAAEgD,QACVX,OAAQrC,EAAEiD,QACVX,UAAU,EAEVY,SAAU1B,EAAU9E,MAAM+E,QAAQ0B,KAAI,gBAAG5E,EAAH,EAAGA,KAAMD,EAAT,EAASA,IAAT,MAAoB,CAAEC,OAAMD,UAClEwE,YACAC,WACAK,MAAQ,WAEN,IAAIA,EAAQ,CAAEX,EAAG,GAAIC,EAAG,IAChBhB,EAAcF,EAAU9E,MAAxBgF,UA2CR,MA1CA,yBACKA,GADL,CAEE,CACEpD,IAAK,EACLC,KAAM,EACNC,OAAQ,EACRK,MAAOhF,EAAK6C,MAAM2G,UAAUxE,MAC5BC,OAAQjF,EAAK6C,MAAM2G,UAAUvE,UAE/B6C,SAAQ,SAAA7D,GACR,IACQwF,EAIJxF,EAJFS,KACKgF,EAGHzF,EAHFQ,IACOkF,EAEL1F,EAFFe,MACQ4E,EACN3F,EADFgB,OAGFsE,EAAMV,EAAE/H,KAAK,CAAE+I,QAASH,EAAMjF,IAAKiF,EAAOV,IAC1CO,EAAMV,EAAE/H,KAAK,CAAE+I,QAASH,EAAOE,EAASnF,IAAKiF,EAAOE,IACpDL,EAAMV,EAAE/H,KAAK,CAAE+I,QAASH,EAAMjF,IAAKiF,IACnCH,EAAMV,EAAE/H,KAAK,CACX+I,QAASH,EAAOE,EAAU,EAC1BnF,IAAKiF,EAAOE,EAAU,EAAIZ,EAAU,IAEtCO,EAAMV,EAAE/H,KAAK,CACX+I,QAASH,EAAOE,EAChBnF,IAAKiF,EAAOE,EAAUZ,IAGxBO,EAAMX,EAAE9H,KAAK,CAAEgJ,SAAUL,EAAO/E,KAAM+E,EAAQV,IAC9CQ,EAAMX,EAAE9H,KAAK,CAAEgJ,SAAUL,EAAQE,EAAQjF,KAAM+E,EAAQE,IACvDJ,EAAMX,EAAE9H,KAAK,CAAEgJ,SAAUL,EAAO/E,KAAM+E,IACtCF,EAAMX,EAAE9H,KAAK,CACXgJ,SAAUL,EAAQE,EAAS,EAC3BjF,KAAM+E,EAAQE,EAAS,EAAIZ,EAAS,IAEtCQ,EAAMX,EAAE9H,KAAK,CACXgJ,SAAUL,EAAQE,EAClBjF,KAAM+E,EAAQE,EAASZ,OAIpBQ,EA9CD,IAkDVQ,SAAS3D,iBAAiB,YAAa4D,GACvCD,SAAS3D,iBAAiB,UAAW6D,IAGjCD,EAAY,SAAA7D,GAChB,IAAMgD,EAAqBhD,EAArBgD,QAASC,EAAYjD,EAAZiD,QACVd,EAAUG,WACbH,EAAUG,UAAW,EACrB5C,EAAOY,KAAK,UAUd,IANA,IAAI/B,EAAOyE,EAAUb,EAAUC,OAASD,EAAUW,UAC9CxE,EAAM2E,EAAUd,EAAUE,OAASF,EAAUY,SAC7CL,EAAI,KACND,EAAI,KAGGtI,EAAI,EAAGA,EAAIgI,EAAUiB,MAAMV,EAAErI,OAAQF,IAAK,CACjD,MAA+BgI,EAAUiB,MAAMV,EAAEvI,GAAhCsB,EAAjB,EAAQiI,QAAiB/G,EAAzB,EAAoB2B,IAEpB,GAAIyF,KAAKC,IAAIrH,EAAI2B,GAAO,EAAG,CACzBoE,EAAIjH,EAEJwH,EAAUd,EAAUE,OAASF,EAAUY,SAAWpG,EAClD,OAIJ,IAAK,IAAIxC,EAAI,EAAGA,EAAIgI,EAAUiB,MAAMX,EAAEpI,OAAQF,IAAK,CACjD,MAAiCgI,EAAUiB,MAAMX,EAAEtI,GAAjCsB,EAAlB,EAAQkI,SAAmB9H,EAA3B,EAAqB0C,KACrB,GAAIwF,KAAKC,IAAInI,EAAI0C,GAAQ,EAAG,CAC1BkE,EAAIhH,EAEJuH,EAAUb,EAAUC,OAASD,EAAUW,UAAYjH,EACnD,OAIJ0G,EAASE,EAAIA,EACbF,EAASG,EAAIA,EAEb,IAAIuB,EAAOjB,EAAUb,EAAUC,OAC7B8B,EAAOjB,EAAUd,EAAUE,OAE7Bb,EAAU9E,MAAM+E,QAAQE,SAAQ,SAAC7D,EAAOqG,GACtCrG,EAAMS,KAAO4D,EAAUe,SAASiB,GAAK5F,KAAO0F,EAC5CnG,EAAMQ,IAAM6D,EAAUe,SAASiB,GAAK7F,IAAM4F,MAIxCJ,EAAU,SAAVA,IACJF,SAAS1C,oBAAoB,YAAa2C,GAC1CD,SAAS1C,oBAAoB,UAAW4C,GACxCvB,EAASE,EAAI,KACbF,EAASG,EAAI,KACTP,EAAUG,WAEZH,EAAUG,UAAW,EACrB5C,EAAOY,KAAK,SAIhB,MAAO,CACLqC,YACAJ,Y,wCCzIW,SAAS6B,EAAWvK,EAAM2H,GACvC,IAAM6C,EAAQ,CACZC,SAAU,EACVC,MAAO,GACPC,SAAU,GACVC,cAAe,GACfC,aAAc,IAGVC,EAAW,SAAAC,GAEfP,EAAMG,SAASI,EAAQ3I,MAAQ,WAC7B,MAAuB2I,EAAQC,QAAR,MAAAD,EAAO,WAAtBE,EAAR,EAAQA,KAAMC,EAAd,EAAcA,KAEd,GADAD,IACKF,EAAQI,UAAb,CAEA,IAAMT,EAAmBF,EAAnBE,MAAOD,EAAYD,EAAZC,QACTC,EAAMlK,SACRkK,EAAQA,EAAM9G,MAAM,EAAG6G,EAAU,GACjCD,EAAME,MAAQA,GAEhBA,EAAM5J,KAAK,CAAEmK,OAAMC,SACnBV,EAAMC,QAAUA,EAAU,IAE5BD,EAAMI,cAAc9J,KAAKiK,IAI3BD,EAAS,CACP1I,KAAM,OACNgJ,SAAU,SACVJ,QAHO,WAIL,MAAO,CACLC,KADK,WAEH,IAAuB,IAAnBT,EAAMC,QAAV,CACA,IAAMY,EAAOb,EAAME,MAAMF,EAAMC,SAC3BY,IACFA,EAAKH,MAAQG,EAAKH,OAClBV,EAAMC,iBAOhBK,EAAS,CACP1I,KAAM,OACNgJ,SAAU,SACVJ,QAHO,WAIL,MAAO,CACLC,KADK,WAEH,IAAMI,EAAOb,EAAME,MAAMF,EAAMC,QAAU,GACrCY,IACFA,EAAKJ,MAAQI,EAAKJ,OAClBT,EAAMC,gBAOhBK,EAAS,CACP1I,KAAM,OACN+I,WAAW,EACXG,KAHO,WAGA,WAELC,KAAKC,OAAS,KAEd,IAAMvE,EAAQ,kBAAO,EAAKuE,OAASC,IAASzL,EAAK6C,MAAMgE,SAEjDK,EAAM,kBAAMsD,EAAMG,SAASe,QAKjC,OAHA7F,EAAO8F,GAAG,QAAS1E,GACnBpB,EAAO8F,GAAG,MAAOzE,GAEV,WACLrB,EAAO+F,IAAI,SACX/F,EAAO+F,IAAI,SAGfZ,QAnBO,WAqBL,IAAMQ,EAASD,KAAKC,OACdK,EAAQ7L,EAAK6C,MAAMgE,OACzB,MAAO,CACLqE,KADK,WAEHlL,EAAK6C,MAAL,iCAAkB7C,EAAK6C,OAAvB,IAA8BgE,OAAQ2E,KAExCP,KAJK,WAKHjL,EAAK6C,MAAL,iCAAkB7C,EAAK6C,OAAvB,IAA8BgE,OAAQgF,SAM9Cf,EAAS,CACP1I,KAAM,kBACN+I,WAAW,EACXH,QAHO,SAGCc,GACN,IAAMN,EAASxL,EAAK6C,MACdgJ,EAAQC,EACd,MAAO,CAELZ,KAFK,WAGHlL,EAAK6C,MAAQ2I,GAGfP,KANK,WAOHjL,EAAK6C,MAAQgJ,OAMrBf,EAAS,CACP1I,KAAM,cACN+I,WAAW,EACXH,QAHO,SAGCc,EAAQC,GACd,IAAMP,EAASC,IAASzL,EAAK6C,MAAMgE,QAC7BgF,EAAS,WACb,IAAMhF,EAAS,eAAI7G,EAAK6C,MAAMgE,QACxByD,EAAMzD,EAAOmF,QAAQD,GAI3B,OAHIzB,GAAO,GACTzD,EAAOnF,OAAO4I,EAAK,EAAGwB,GAEjBjF,EANM,GASf,MAAO,CAELqE,KAFK,WAGHlL,EAAK6C,MAAL,iCAAkB7C,EAAK6C,OAAvB,IAA8BgE,OAAQ2E,KAGxCP,KANK,WAOHjL,EAAK6C,MAAL,iCAAkB7C,EAAK6C,OAAvB,IAA8BgE,OAAQgF,SAM9Cf,EAAS,CACP1I,KAAM,WACN+I,WAAW,EACXH,QAHO,WAIL,MAA6BrD,EAAU9E,MAAjC+E,EAAN,EAAMA,QAASC,EAAf,EAAeA,UACT2D,EAASC,IAASzL,EAAK6C,MAAMgE,QAC7BgF,EAAS,WACb,IAAII,EAAYpE,EAAUrC,QAAO,SAACC,EAAMxB,GACtC,OAAOiG,KAAKgC,IAAIzG,EAAMxB,EAAMU,WAC1BwH,KAGJ,OAFAvE,EAAQE,SAAQ,SAAA7D,GAAK,OAAKA,EAAMU,OAASsH,EAAY,KAE9CjM,EAAK6C,MAAMgE,OANL,GASf,MAAO,CACLqE,KADK,WAEHlL,EAAK6C,MAAL,iCAAkB7C,EAAK6C,OAAvB,IAA8BgE,OAAQ2E,KAExCP,KAJK,WAKHjL,EAAK6C,MAAL,iCAAkB7C,EAAK6C,OAAvB,IAA8BgE,OAAQgF,SAM9Cf,EAAS,CACP1I,KAAM,cACN+I,WAAW,EACXH,QAHO,WAIL,MAA6BrD,EAAU9E,MAAjC+E,EAAN,EAAMA,QAASC,EAAf,EAAeA,UACT2D,EAASC,IAASzL,EAAK6C,MAAMgE,QAC7BgF,EAAS,WACb,IAAIO,EACFvE,EAAUrC,QAAO,SAACC,EAAMxB,GACtB,OAAOiG,KAAKmC,IAAI5G,EAAMxB,EAAMU,UAC3BwH,KAAY,EAEjB,GAAIC,EAAY,EAAG,CACjB,IAAME,EAAMpC,KAAKC,IAAIiC,GACrBA,EAAY,EACZvE,EAAUC,SAAQ,SAAA7D,GAAK,OAAKA,EAAMU,QAAU2H,KAI9C,OAFA1E,EAAQE,SAAQ,SAAA7D,GAAK,OAAKA,EAAMU,OAASyH,KAElCpM,EAAK6C,MAAMgE,OAbL,GAgBf,MAAO,CACLqE,KADK,WAEHlL,EAAK6C,MAAL,iCAAkB7C,EAAK6C,OAAvB,IAA8BgE,OAAQ2E,KAExCP,KAJK,WAKHjL,EAAK6C,MAAL,iCAAkB7C,EAAK6C,OAAvB,IAA8BgE,OAAQgF,SAM9Cf,EAAS,CACP1I,KAAM,SACN+I,WAAW,EACXH,QAHO,WAIL,IAAMQ,EAASC,IAASzL,EAAK6C,MAAMgE,QAC7BgF,EAAQlE,EAAU9E,MAAMgF,UAC9B,MAAO,CACLqD,KADK,WAEHlL,EAAK6C,MAAL,iCAAkB7C,EAAK6C,OAAvB,IAA8BgE,OAAQ2E,KAExCP,KAJK,WAKHjL,EAAK6C,MAAL,iCAAkB7C,EAAK6C,OAAvB,IAA8BgE,OAAQgF,SAM9C,IAAMU,EAAiB,WACrB,IAAMC,EAAW,CACfC,GAAI,IACJC,GAAI,KAEAC,EAAY,SAAAxG,GAChB,IAAQyG,EAAqBzG,EAArByG,QAASzE,EAAYhC,EAAZgC,QACb0E,EAAY,GACZ1E,GAAS0E,EAAU/L,KAAK,QAC5B+L,EAAU/L,KAAK0L,EAASI,IACxBC,EAAYA,EAAUC,KAAK,KAE3BtC,EAAMI,cAAc9C,SAAQ,YAAwB,IAArBsD,EAAqB,EAArBA,SAAUhJ,EAAW,EAAXA,KAClCgJ,GACDA,IAAayB,IACfrC,EAAMG,SAASvI,KACf+D,EAAES,sBAIF0E,EAAO,WAGX,OAFA5H,OAAO0C,iBAAiB,UAAWuG,GAE5B,WACLjJ,OAAO2D,oBAAoB,UAAWsF,KAG1C,OAAOrB,EA3Bc,GA2CvB,OAbA,WAGEd,EAAMK,aAAa/J,KAAKyL,KACxB/B,EAAMI,cAAc9C,SAAQ,SAAAiD,GAC1BA,EAAQO,MAAQd,EAAMK,aAAa/J,KAAKiK,EAAQO,WAIlDyB,gBAAY,WACVvC,EAAMK,aAAa/C,SAAQ,SAAAkF,GAAE,OAAIA,GAAMA,UAV3C,GAaOxC,E,IClNLyC,E,YArDEC,EAAkBnJ,eAAgB,CACtCC,MAAO,CACLmJ,OAAQ1M,QAEVyD,MAJsC,SAIhCF,EAAOoJ,GACX,IAAM5C,EAAQ7B,eAAS,CACrB0E,QAAQ,EACRF,OAAQnJ,EAAMmJ,SAGhBC,EAAIE,OAAO,CACTC,WADS,SACEJ,GACT3C,EAAM6C,QAAS,EACf7C,EAAM2C,OAASA,KAInB,IAAMK,EAAW,WACfhD,EAAM6C,QAAS,GAEXI,EAAY,WAChBjD,EAAM6C,QAAS,EACf7C,EAAM2C,OAAOO,SAAWlD,EAAM2C,OAAOO,QAAQlD,EAAM2C,OAAOQ,UAG5D,OAAO,WAEL,yCACqBnD,EAAM6C,OAD3B,yCACqB7C,EAAM6C,OAD3B,SAC0C7C,EAAM2C,OAAOS,OADvD,CAGM5G,QAAS,iCAAC,QAAD,KAEA,WAFA,KAGC,GAHD,WAIIwD,EAAM2C,OAAOQ,QAJjB,yCAIInD,EAAM2C,OAAOQ,QAJjB,WAOTE,OAAQ,kBACNrD,EAAM2C,OAAOU,QAAb,uDAEmB,UAFnB,QAEsCJ,GAFtC,mFAKuBD,GALvB,6DAgBd,SAASM,EAAQX,GACf,IAAKF,EAAI,CACP,IAAIc,EAAKhE,SAASiE,cAAc,OAChCf,EAAKgB,eAAYf,EAAiB,CAAEC,WACpCpD,SAASmE,KAAKC,aAAa9I,eAAO4H,EAAIc,GAAKA,IAE7C,IAAMR,EAAeN,EAAG/H,UAAUkJ,QAA5Bb,WACNA,EAAWJ,GAGEW,IC+BXb,ED/BWa,ICrDFO,EAAetK,eAAgB,CAC1CC,MAAO,CACLsK,MAAO,CACLC,KAAMC,OACNC,UAAU,GAEZC,KAAMF,OACNG,QAAS,CACPJ,KAAMK,WAIV1K,MAZ0C,YAYnB,IAAfwK,EAAe,EAAfA,KAAMJ,EAAS,EAATA,MACNO,EAAOzK,eAAO,gBACpB,OAAO,WACL,mCACa,gBADb,QACsCyK,GADtC,2BAEcH,EAFd,MAE0B,qBAF1B,MAGKJ,QAQLQ,EAAoB/K,eAAgB,CACxCC,MAAO,CACLmJ,OAAQ,CAAEoB,KAAM9N,SAElByD,MAJwC,SAIlCF,EAAOoJ,GACX,IAAM2B,EAAczK,eAAI,MAClBkG,EAAQ7B,eAAS,CACrBqG,MAAM,EACN7B,OAAQnJ,EAAMmJ,OACd1I,IAAK,EACLC,KAAM,IAGFuK,EAAQzK,gBAAS,iBAAO,CAC5BE,KAAM8F,EAAM9F,KACZD,IAAK+F,EAAM/F,QAGb2I,EAAIE,OAAO,CACT4B,aADS,SACI/B,GACX3C,EAAM2C,OAASA,EACf3C,EAAMwE,MAAO,EACb,MAA6BxE,EAAM2C,OAAOhH,EAAlCgD,EAAR,EAAQA,QAASC,EAAjB,EAAiBA,QACjBoB,EAAM9F,KAAOyE,EAAU,GAAK,KAC5BqB,EAAM/F,IAAM2E,EAAU,GAAK,QAI/B+F,eAAQ,gBAAgB,WACtB3E,EAAMwE,MAAO,KAGf,IAAMI,EAAc,SAAAjJ,GACb4I,EAAYlM,MAAMwM,SAASlJ,EAAEgB,UAASqD,EAAMwE,MAAO,IAU1D,OAPApK,gBAAU,WACRmF,SAAS3D,iBAAiB,YAAagJ,GAAa,MAEtDE,gBAAgB,WACdvF,SAAS1C,oBAAoB,YAAa+H,GAAa,MAGlD,WACL,mDAEU,WAFV,MAGWH,EAAMpM,MAHjB,IAKSkM,GALT,CAOK/K,EAAMmJ,OAAOQ,YAPlB,SAIYnD,EAAMwE,YAWlBO,EAAY,SAAApC,GAChB,IAAKF,EAAI,CACP,IAAMc,EAAKhE,SAASiE,cAAc,OAClCf,EAAKgB,eAAYa,EAAmB,CAAE3B,WACtCpD,SAASmE,KAAKC,aAAa9I,eAAO4H,EAAIc,GAAKA,IAE7C,IAAQmB,EAAiBjC,EAAG/H,UAAUkJ,QAA9Bc,aACRA,EAAa/B,IAGAoC,I,qJChGAxL,qBAAgB,CAC7BC,MAAO,CACLC,MAAOxD,OACPT,KAAMS,OACN+O,gBAAiBZ,SACjBa,YAAab,UAEf1K,MAP6B,SAOvBF,GACJ,IAAMG,EAASC,eAAO,UAChBoG,EAAQ7B,eAAS,CAAE+G,SAAU,KAC7BC,EAAQ,WACP3L,EAAMC,MAGTuG,EAAMkF,SAAWjE,IAASzH,EAAMC,OAFhCuG,EAAMkF,SAAWjE,IAASzH,EAAMhE,KAAKwJ,YAKnCrI,EAAQ,WACP6C,EAAMC,MAKTD,EAAMyL,YAAYjF,EAAMkF,SAAU1L,EAAMC,OAHxCD,EAAMwL,gBAAN,iCAA2BxL,EAAMhE,MAAjC,IAAuCwJ,UAAWgB,EAAMkF,aAS5D,OAFAE,gBAAM,kBAAM5L,EAAMC,QAAO0L,EAAO,CAAEE,WAAW,IAEtC,WACL,IAAIlC,EAAU,GACd,GAAK3J,EAAMC,MAWJ,CACL,IAAMiB,EAAYf,EAAOgB,aAAanB,EAAMC,MAAMd,KAC9C+B,GAAaA,EAAUlB,OACzBvD,OAAOqP,QAAQ5K,EAAUlB,OAAOsF,KAAI,YAA4B,4BAA1ByG,EAA0B,KAAhBC,EAAgB,KAC9DrC,EAAQ7M,KAAR,6BACqBkP,EAAW1B,OADhC,IAEK,CACC2B,MAAO,iCAAC,QAAD,WACazF,EAAMkF,SAAS1L,MAAM+L,GADlC,yCACavF,EAAMkF,SAAS1L,MAAM+L,GADlC,WAGPG,MAAO,iCAAC,QAAD,WACmB1F,EAAMkF,SAAS1L,MAAM+L,GADxC,yCACmBvF,EAAMkF,SAAS1L,MAAM+L,GADxC,WAGPI,OAAQ,uCAAC,QAAD,WACa3F,EAAMkF,SAAS1L,MAAM+L,GADlC,yCACavF,EAAMkF,SAAS1L,MAAM+L,GADlC,QAEHC,EAAWI,QAAQ9G,KAAI,gBAAGzG,EAAH,EAAGA,MAAOyL,EAAV,EAAUA,MAAV,sBAAC,QAAD,MACLzL,EADK,MACSyL,GADT,UAFpB,qCAOR0B,EAAWzB,SAhBjB,uCAsBArJ,GAAaA,EAAUI,OAEzB7E,OAAOqP,QAAQ5K,EAAUI,OAAOgE,KAAI,YAAwB,0BAAtB5D,EAAsB,KAAX4I,EAAW,KAC1DX,EAAQ7M,KAAR,6BACqBwN,GADrB,6DAEsB9D,EAAMkF,SAASpK,MAAMI,GAF3C,yCAEsB8E,EAAMkF,SAASpK,MAAMI,GAF3C,uBAvCJiI,EAAQ7M,KAAR,yDAEsB,QAFtB,6DAG8B0J,EAAMkF,SAAS1K,MAH7C,yCAG8BwF,EAAMkF,SAAS1K,MAH7C,2CAKsB,QALtB,6DAM8BwF,EAAMkF,SAASzK,OAN7C,yCAM8BuF,EAAMkF,SAASzK,OAN7C,iBAgDF,+CACyB,MADzB,MACqC,gBADrC,2BAEK0I,EAFL,kFAIqB,UAJrB,QAIwCxM,GAJxC,mFAOyBwO,GAPzB,gECjFS5L,iBAAgB,CAC7BC,MAAO,CACL2B,WAAYlF,OACZqD,SAAUrD,QAEZ4P,MAAO,CAAC,qBACRC,WAAY,CAAEC,eACdrM,MAP6B,SAOvBF,EAPuB,GAON,IAARyC,EAAQ,EAARA,KACPT,EAAe1B,eAAI,MACnBiD,EAAYjD,gBAAI,GAChBkM,EAAYlM,gBAAI,GAChBH,EAASC,eAAO,UAChBpE,EAAOwE,eAAS,CACpB/B,IADoB,WAElB,OAAOuB,EAAM2B,YAEf8K,IAJoB,SAIhBC,GACFjK,EAAK,oBAAqBgF,IAASiF,OAGjCC,EAAenM,gBAAS,WAC5B,MAAO,CACLQ,MAAOhF,EAAK6C,MAAM2G,UAAUxE,MAAQ,KACpCC,OAAQjF,EAAK6C,MAAM2G,UAAUvE,OAAS,SAK1C,EAA+Bc,EAAQC,EAAchG,GAA7CkG,EAAR,EAAQA,UAAWkB,EAAnB,EAAmBA,QAEnB,EAKIE,EAAStH,EAAMuH,GAAW,SAAApB,GAAC,OAAI2C,EAAU3C,MAJ3C6B,EADF,EACEA,eACAI,EAFF,EAEEA,gBACAT,EAHF,EAGEA,UACAD,EAJF,EAIEA,gBAGF,EAAgCW,EAC9BV,EACAD,EACA1H,GAHM8I,EAAR,EAAQA,UAAWJ,EAAnB,EAAmBA,SAMnB,EAAqB6B,EAAWvK,EAAM2H,GAA9BgD,EAAR,EAAQA,SAEFiG,EAAqB,SAACzK,EAAGlC,GAC7BkC,EAAES,iBACF2I,EAAU,CACRpJ,IACA4H,GAAI5H,EAAEgB,OACNwG,QAAS,WACP,0DAGW,mBAHX,MAIY,KAJZ,QAKe,WACPhD,EAASkG,aANjB,8BAUY,KAVZ,KAWW,sBAXX,QAYe,WACPlG,EAASmG,gBAbjB,6BAiBW,aAjBX,MAkBY,KAlBZ,QAmBe,WACPhD,EAAQ,CACNF,MAAO,SACPD,QAASoD,KAAKC,UAAU/M,OAtBlC,6BA2BW,cA3BX,MA4BY,KA5BZ,QA6Be,WACP6J,EAAQ,CACNF,MAAO,OACPD,QAAS,GACTE,QAAQ,EACRH,QAJM,SAIEuD,GACNtG,EAAS8E,YAAYsB,KAAKG,MAAMD,GAAOhN,QAnCnD,8BAyCY,KAzCZ,KA0CW,6BA1CX,QA2Ce,WACP0G,EAASwG,WA5CjB,YAqDAC,EAAU,CACd,CACE9C,MAAO,KACP+C,MAAO,YACPC,OAAQ3G,EAASO,MAEnB,CACEoD,MAAO,KACP+C,MAAO,oBACPC,OAAQ3G,EAASM,MAEnB,CACEqD,MAAO,KACP+C,MAAO,cACPC,OAAQ,WACNxD,EAAQ,CACNF,MAAO,WACPD,QAAS,GACTE,QAAQ,EACRH,QAJM,SAIEuD,GAENtG,EAAS6E,gBAAgBuB,KAAKG,MAAMD,SAK5C,CACE3C,MAAO,KACP+C,MAAO,cACPC,OAAQ,WACNxD,EAAQ,CACNF,MAAO,WACPD,QAASoD,KAAKC,UAAUhR,EAAK6C,WAInC,CACEyL,MAAO,KACP+C,MAAO,mBACPC,OAAQ3G,EAASkG,UAEnB,CACEvC,MAAO,KACP+C,MAAO,sBACPC,OAAQ3G,EAASmG,aAEnB,CACExC,MAAO,KACP+C,MAAO,6BACPC,OAAQ3G,EAASwG,QAEnB,CACE7C,MAAO,kBAAO/G,EAAU1E,MAAQ,KAAO,MACvCwO,MAAO,kBAAO9J,EAAU1E,MAAQ,aAAe,eAC/CyO,OAAQ,WACN/J,EAAU1E,OAAS0E,EAAU1E,MAC7BuF,MAGJ,CACEkG,MAAO,KACP+C,MAAO,cACPC,OAAQ,WACNd,EAAU3N,OAAQ,EAClBuF,OAKN,OAAO,kBACJoI,EAAU3N,MAAX,4BAwBa,UAxBb,+BA0BOuO,EAAQ9H,KAAI,SAAAiI,GACX,IAAMjD,EACiB,oBAAdiD,EAAIjD,MAAuBiD,EAAIjD,QAAUiD,EAAIjD,MAChDkD,EACiB,oBAAdD,EAAIF,MAAuBE,EAAIF,QAAUE,EAAIF,MACtD,mCACa,cADb,QACoCE,EAAID,QADxC,CAEKhD,EAFL,0BAGcA,EAHd,MAG4B,CAACkD,IAH7B,aA/BR,6BAwCOrN,EAAOsN,cAAcnI,KAAI,SAAApE,GAAS,mCAEzB,yBAFyB,yBAIlB,SAAAiB,GACXD,EAAUC,EAAGjB,IALgB,UAOpBkC,GAPoB,8BASnB,qBATmB,CASElC,EAAUoJ,QAC1CpJ,EAAUwM,iBAlDrB,uDAwDehK,EAAgB7E,MAxD/B,KAyDc7C,EAAK6C,MAzDnB,gBA0DyB8H,EAAS6E,gBA1DlC,YA2DqB7E,EAAS8E,aA3D9B,gEAgEiB,iBAhEjB,6BAkEgB,yBAlEhB,MAmEiBkB,EAAa9N,MAnE9B,IAoEemD,EApEf,YAqEuB,SAAAG,GAAC,OAAIiC,MArE5B,CAuEWpI,EAAK6C,MAAMgE,OAAOyC,KAAI,SAACrF,EAAOgE,GAAR,sBAAC,GAAD,MAEZ,CACLhE,EAAM8D,MAAQ,qBAAuB,GACpCR,EAAU1E,MAAuB,GAAf,cAJF,MAMZoB,EANY,YAON,SAAAkC,GAAC,OAAI6B,EAAe7B,EAAGlC,EAAOgE,IAPxB,cAQJ,SAAA9B,GACbyK,EAAmBzK,EAAGlC,IATL,SAWTD,EAAMF,UAXG,SAeP,OAAf4E,EAASE,GAAT,4BAES,cAFT,MAGU,CAAElE,KAAMgE,EAASE,EAAI,OAH/B,MAMe,OAAfF,EAASG,GAAT,4BACY,cADZ,MACiC,CAAEpE,IAAKiE,EAASG,EAAI,OADrD,cA5FX,4BACa,UADb,6BAGW,UAHX,MAIY,wCAJZ,QAKe,WACP2H,EAAU3N,OAAQ,IAN1B,sDAWKkO,KAAKC,UAAUhN,EAAMF,UAX1B,wDAciB,iBAdjB,6BAemB,yBAfnB,MAemD6M,EAAa9N,OAfhE,CAgBW7C,EAAK6C,MAAMgE,OAAOyC,KAAI,SAAArF,GAAK,+BACNA,EADM,SACWD,EAAMF,UADjB,qBCvM7BC,G,UAAAA,eAAgB,CAC7BC,MAAO,CACLiD,MAAOuH,OAASmD,OAChBzK,IAAKsH,OAASmD,QAEhBtB,MAAO,CAAC,eAAgB,cACxBnM,MAN6B,SAMvBF,EAAOoJ,GACX,IAAMnG,EAAQzC,eAAS,CACrB/B,IADqB,WAEnB,OAAOuB,EAAMiD,OAEfwJ,IAJqB,SAIjBC,GACFtD,EAAI3G,KAAK,eAAgBiK,MAGvBxJ,EAAM1C,eAAS,CACnB/B,IADmB,WAEjB,OAAOuB,EAAMkD,KAEfuJ,IAJmB,SAIfC,GACFtD,EAAI3G,KAAK,aAAciK,MAI3B,OAAO,8CACM,YADN,gBAAC,QAAD,KAEW,OAFX,WAE2BzJ,EAAMpE,MAFjC,yCAE2BoE,EAAMpE,MAFjC,+BAE6C,IAF7C,eAAC,QAAD,KAGW,OAHX,WAG2BqE,EAAIrE,MAH/B,yCAG2BqE,EAAIrE,MAH/B,iBCxBX,SAAS+O,IACP,IAAIH,EAAgB,GAChBtM,EAAe,GACnB,MAAO,CACLsM,gBACAtM,eACA2F,SAHK,SAGI5F,GACFC,EAAaD,EAAU/B,OAC1BgC,EAAaD,EAAU/B,KAAO+B,EAC9BuM,EAAc3Q,KAAKoE,MAM3B,IAAI2M,EAAiBD,IAEfE,EAAkB,SAAAxD,GACtB,MAAO,CAAEC,KAAM,QAASD,UAEpByD,EAAkB,SAAAzD,GACtB,MAAO,CAAEC,KAAM,QAASD,UAEpB0D,EAAmB,SAAC1D,EAAO8B,GAC/B,MAAO,CAAE7B,KAAM,SAAUD,QAAO8B,YAGlCyB,EAAe/G,SAAS,CACtB3H,IAAK,OACLmL,MAAO,KACPoD,QAAS,iBAAM,QACfrM,OAAQ,gBAAGrB,EAAH,EAAGA,MAAH,oCACO,CAAEkM,MAAOlM,EAAMkM,MAAO+B,SAAUjO,EAAMkO,OAD7C,CAEHlO,EAAMiN,MAAQ,UAGnBjN,MAAO,CACLiN,KAAMa,EAAgB,QACtB5B,MAAO6B,EAAgB,QACvBG,KAAMF,EAAiB,OAAQ,CAC7B,CAAEnP,MAAO,OAAQyL,MAAO,QACxB,CAAEzL,MAAO,OAAQyL,MAAO,QACxB,CAAEzL,MAAO,OAAQyL,MAAO,aAK9BuD,EAAe/G,SAAS,CACtB3H,IAAK,SACLmL,MAAO,KACPoD,QAAS,iCAAC,aAAD,oDACTrM,OAAQ,gBAAGrB,EAAH,EAAGA,MAAH,sBAAC,QAAD,KACUA,EAAMuK,KADhB,KAC4BvK,EAAMkO,MADlC,2BAEHlO,EAAMiN,MAAQ,YAGnBjN,MAAO,CACLiN,KAAMa,EAAgB,QACtBvD,KAAMyD,EAAiB,OAAQ,CAC7B,CAAEnP,MAAO,UAAWyL,MAAO,MAC3B,CAAEzL,MAAO,UAAWyL,MAAO,MAC3B,CAAEzL,MAAO,UAAWyL,MAAO,MAC3B,CAAEzL,MAAO,SAAUyL,MAAO,MAC1B,CAAEzL,MAAO,OAAQyL,MAAO,QAE1B4D,KAAMF,EAAiB,OAAQ,CAC7B,CAAEnP,MAAO,SAAUyL,MAAO,MAC1B,CAAEzL,MAAO,QAASyL,MAAO,KACzB,CAAEzL,MAAO,OAAQyL,MAAO,WAK9BuD,EAAe/G,SAAS,CACtB3H,IAAK,QACLmL,MAAO,MACPoD,QAAS,iCAAC,QAAD,YAA2B,OAA3B,OACTrM,OAAQ,gBAAGC,EAAH,EAAGA,MAAH,sBAAC,sBAA2BA,EAAM0B,QAAlC,aAAuD,QAAvD,OACR1B,MAAO,CACL0B,QAAS,WAYb6K,EAAe/G,SAAS,CACtB3H,IAAK,QACLmL,MAAO,QACPoD,QAAS,iCAAC,cACVrM,OAAQ,gBAAGC,EAAH,EAAGA,MAAH,sBAAC,GAAD,MAEGA,EAAM2B,MAAMtB,WAFf,IAGCL,EAAM4B,IAAIvB,WAHX,iBAIYL,EAAM2B,MAAM,uBAJxB,eAKU3B,EAAM4B,IAAI,wBALpB,OAQR5B,MAAO,CACL2B,MAAO,QACPC,IAAK,WAIM2K,QZtGA,GACbzP,KAAM,MACNkO,WAAY,CAAE6B,OAAA,GACdjO,MAHa,WAIX,IAAML,EAAS,eAAI,GAEbC,EAAW,eAAI,CACnBsO,SAAU,WACVnL,MAAO,EACPC,IAAK,MAoBP,OAFA,eAAQ,SAAU,GAEX,CACLrD,SACAC,c,qBapCN,MAAMuO,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAAS,KAErD,Q,oBCDfC,eAAUC,GAEPC,MAAM,S","file":"js/app.d76d0688.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/lowcode_vue3/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","<template>\n  <Editor v-model=\"source\" :formData=\"formData\" />\n</template>\n\n<script>\nimport { provide, ref } from 'vue';\nimport data from './json/data';\nimport Editor from './packages/editor';\nimport { default as config } from './utils/editor-config';\n\nexport default {\n  name: 'App',\n  components: { Editor },\n  setup() {\n    const source = ref(data);\n    //双向绑定数据源\n    const formData = ref({\n      username: 'username',\n      start: 0,\n      end: 100\n    });\n    /*data:  {\n      container: {\n        width: 800,\n        height: 800,\n      },\n      blocks: [\n        {top: 100,left: 100,zIndex: 1,key: \"text\",\"props\":{\n          \"text\":\"文字\",\"color\":\"#333\",\"size\":\"16px\"\n        }},\n        {top: 200,left: 200,zIndex: 1,key: \"button\",\"props\":{\n          \"text\":\"文字\",\"type\":\"primary\",\"size\":\"medium\"\n        }},\n        {top: 300,left: 300,zIndex: 1,key: \"input\",\"props\":{},\"model\":{}},\n      ],\n    }  */\n\n    provide('config', config);\n\n    return {\n      source,\n      formData\n    };\n  }\n};\n</script>\n","import { computed, defineComponent, inject, onMounted, ref } from 'vue';\nexport default defineComponent({\n  props: {\n    block: Object, //{  \"top\": 100, \"left\": 100, \"zIndex\": 1, \"key\": \"text\",width,height }\n    formData: Object\n  },\n  setup(props) {\n    const config = inject('config');\n    const blockRef = ref(null);\n    const blockStyle = computed(() => ({\n      top: `${props.block.top}px`,\n      left: `${props.block.left}px`,\n      zIndex: props.block.zIndex\n    }));\n\n    onMounted(() => {\n      //居中渲染拖入的组件\n      const { offsetWidth, offsetHeight } = blockRef.value;\n      if (props.block.alignCenter) {\n        props.block.left -= offsetWidth / 2;\n        props.block.top -= offsetHeight / 2;\n        props.block.alignCenter = false;\n      }\n      //加上width 和height\n      props.block.width = offsetWidth;\n      props.block.height = offsetHeight;\n    });\n\n    return () => {\n      const component = config.componentMap[props.block.key];\n\n      // {default:'username',start:'',end:''}\n      const renderComponent = component.render({\n        props: props.block.props,\n        model: Object.keys(component.model || {}).reduce((prev, modelName) => {\n          prev[modelName] = {\n            modelValue: props.formData[props.block.model[modelName]],\n            'onUpdate:modelValue': v =>\n              (props.formData[props.block.model[modelName]] = v)\n          };\n          return prev;\n        }, {})\n      });\n\n      return (\n        <div class='editor-block' ref={blockRef} style={blockStyle.value}>\n          {renderComponent}\n        </div>\n      );\n    };\n  }\n});\n","import mitt from 'mitt';\n\nconst events = mitt();\nexport default events;\n","import events from './event';\n\nexport default function useDrag(containerRef, data) {\n  let currentComponent = null;\n\n  const dragstart = (e, component) => {\n    currentComponent = component;\n    containerRef.value.addEventListener('dragenter', dragenter);\n    containerRef.value.addEventListener('dragover', dragover);\n    containerRef.value.addEventListener('drop', drop);\n    containerRef.value.addEventListener('dragleave', dragleave);\n    events.emit('start');\n  };\n\n  // 拖动进入目标元素的时候\n  const dragenter = e => {\n    e.dataTransfer.dropEffect = 'move';\n  };\n\n  //经过目标元素的时候，阻止默认事件，不然ondrop事件不触发\n  const dragover = e => {\n    e.preventDefault();\n  };\n\n  //拖拽元素松开时候 根据拖拽元素添加一个组件\n  const drop = e => {\n    let { blocks } = data.value;\n    data.value = {\n      ...data.value,\n      blocks: [\n        ...blocks,\n        {\n          left: e.offsetX,\n          top: e.offsetY,\n          zIndex: 1,\n          key: currentComponent.key,\n          alignCenter: true, // 希望松手的时候你可以居中\n          props: {},\n          model: {\n            default: 'username',\n            start: 'start',\n            end: 'end'\n          }\n        }\n      ]\n    };\n    currentComponent = null;\n  };\n\n  //离开目标元素 增加禁用标识\n  const dragleave = (e, target) => {\n    e.dataTransfer.dropEffect = 'none';\n  };\n\n  // 取消目标元素的事件绑定\n  const dragend = e => {\n    containerRef.value.removeEventListener('dragenter', dragenter);\n    containerRef.value.removeEventListener('dragover', dragover);\n    containerRef.value.removeEventListener('drop', drop);\n    containerRef.value.removeEventListener('dragleave', dragleave);\n    events.emit('end');\n  };\n\n  return {\n    dragstart,\n    dragend\n  };\n}\n","import { computed, ref } from 'vue';\n\nexport default function useFocus(data, isPreview, cb) {\n  let selectIndex = ref(-1); //没有被选中\n  //最后选中的组件\n  const lastSelectBlock = computed(() => data.value.blocks[selectIndex.value]);\n\n  const focusData = computed(() => {\n    let focused = [],\n      unfocused = [];\n    data.value.blocks.forEach(block =>\n      (block.focus ? focused : unfocused).push(block)\n    );\n    return { focused, unfocused };\n  });\n\n  //按下block组件\n  const blockMouseDown = (e, block, index) => {\n    if (isPreview.value) return;\n    e.preventDefault();\n    e.stopPropagation();\n\n    if (!block.focus) {\n      if (!e.ctrlKey) clearBlockFocus(); //如果按了ctrl键就不清除\n      block.focus = true;\n    } else {\n      // block.focus = false;\n    }\n    selectIndex.value = index;\n    cb && cb(e);\n  };\n\n  //清空选中\n  const clearBlockFocus = () => {\n    selectIndex.value = -1;\n    data.value.blocks.forEach(block => (block.focus = false));\n  };\n\n  return {\n    focusData,\n    blockMouseDown,\n    clearBlockFocus,\n    lastSelectBlock\n  };\n}\n","import { reactive } from 'vue';\nimport events from './event';\n\nexport default function useBlockDrag(focusData, lastSelectBlock, data) {\n  let dragState = {\n    startX: 0,\n    startY: 0,\n    dragging: false //默认不是正在拖拽\n  };\n  let markLine = reactive({ x: null, y: null });\n\n  //按下组件\n  const blockDrag = e => {\n    const {\n      width: BWidth,\n      height: BHeight,\n      left: startLeft,\n      top: startTop\n    } = lastSelectBlock.value;\n\n    dragState = {\n      startX: e.clientX,\n      startY: e.clientY,\n      dragging: false,\n      //startPos记录开始位置\n      startPos: focusData.value.focused.map(({ left, top }) => ({ left, top })),\n      startLeft, //拖拽前当前组件的left\n      startTop, //拖拽前当前组件的top\n      lines: (() => {\n        //将每个未获取焦点的组件的5根辅助线列出来\n        let lines = { x: [], y: [] }; //x是垂直方向的辅助线，y是水平方向的辅助线\n        const { unfocused } = focusData.value;\n        [\n          ...unfocused,\n          {\n            top: 0,\n            left: 0,\n            zIndex: 1,\n            width: data.value.container.width,\n            height: data.value.container.height\n          }\n        ].forEach(block => {\n          const {\n            left: ALeft,\n            top: ATop,\n            width: AWidth,\n            height: AHeight\n          } = block;\n\n          lines.y.push({ showTop: ATop, top: ATop - BHeight }); //顶对底\n          lines.y.push({ showTop: ATop + AHeight, top: ATop + AHeight }); //底对顶\n          lines.y.push({ showTop: ATop, top: ATop }); //顶对顶\n          lines.y.push({\n            showTop: ATop + AHeight / 2,\n            top: ATop + AHeight / 2 - BHeight / 2\n          }); //中对中\n          lines.y.push({\n            showTop: ATop + AHeight,\n            top: ATop + AHeight - BHeight\n          }); //底对底\n\n          lines.x.push({ showLeft: ALeft, left: ALeft - BWidth }); //顶对底\n          lines.x.push({ showLeft: ALeft + AWidth, left: ALeft + AWidth }); //底对顶\n          lines.x.push({ showLeft: ALeft, left: ALeft }); //顶对顶\n          lines.x.push({\n            showLeft: ALeft + AWidth / 2,\n            left: ALeft + AWidth / 2 - BWidth / 2\n          }); //中对中\n          lines.x.push({\n            showLeft: ALeft + AWidth,\n            left: ALeft + AWidth - BWidth\n          }); //底对底\n        });\n\n        return lines;\n      })()\n    };\n\n    document.addEventListener('mousemove', mousemove);\n    document.addEventListener('mouseup', mouseup);\n  };\n\n  const mousemove = e => {\n    let { clientX, clientY } = e;\n    if (!dragState.dragging) {\n      dragState.dragging = true;\n      events.emit('start');\n    }\n    //获取最新left top,在辅助线中找，找到显示线\n    // 鼠标移动后 - 鼠标移动前 + left\n    let left = clientX - dragState.startX + dragState.startLeft;\n    let top = clientY - dragState.startY + dragState.startTop;\n    let y = null,\n      x = null;\n\n    //水平方向的辅助线 距离3px就显示辅助线\n    for (let i = 0; i < dragState.lines.y.length; i++) {\n      const { showTop: s, top: t } = dragState.lines.y[i];\n      //移动时比较当前移动组件和预计显示辅助线高度top\n      if (Math.abs(t - top) < 3) {\n        y = s;\n        //贴边  让 clientY变为0\n        clientY = dragState.startY - dragState.startTop + t;\n        break;\n      }\n    }\n    //垂直方向的辅助线 距离5px就显示辅助线\n    for (let i = 0; i < dragState.lines.x.length; i++) {\n      const { showLeft: s, left: l } = dragState.lines.x[i];\n      if (Math.abs(l - left) < 3) {\n        x = s;\n        //贴边 让 clientX变为0\n        clientX = dragState.startX - dragState.startLeft + l;\n        break;\n      }\n    }\n\n    markLine.x = x;\n    markLine.y = y;\n\n    let durX = clientX - dragState.startX,\n      durY = clientY - dragState.startY;\n\n    focusData.value.focused.forEach((block, idx) => {\n      block.left = dragState.startPos[idx].left + durX;\n      block.top = dragState.startPos[idx].top + durY;\n    });\n  };\n\n  const mouseup = () => {\n    document.removeEventListener('mousemove', mousemove);\n    document.removeEventListener('mouseup', mouseup);\n    markLine.x = null;\n    markLine.y = null;\n    if (dragState.dragging) {\n      //只是点击不会触发\n      dragState.dragging = false;\n      events.emit('end');\n    }\n  };\n\n  return {\n    blockDrag,\n    markLine\n  };\n}\n","import deepcopy from 'deepcopy';\nimport { onUnmounted } from 'vue';\nimport events from './event';\n\n//带有历史记录的功能常用这种注册模式\n\nexport default function useCommand(data, focusData) {\n  const state = {\n    current: -1, //当前指针 前进后退的索引\n    queue: [], //所有的操作命令\n    commands: {}, //命令和执行函数的映射表 undo:()=>{} redo:()=>{} drag:()=>{}...\n    commandsArray: [], //存放所有命令\n    destroyArray: [] //销毁队列\n  };\n\n  const register = command => {\n    //命令name对应执行函数\n    state.commands[command.name] = (...args) => {\n      const { redo, undo } = command.execute(...args);\n      redo(); //走下一步\n      if (!command.pushQueue) return;\n\n      let { queue, current } = state;\n      if (queue.length) {\n        queue = queue.slice(0, current + 1);\n        state.queue = queue;\n      }\n      queue.push({ redo, undo });\n      state.current = current + 1;\n    };\n    state.commandsArray.push(command);\n  };\n\n  //撤销(上一步)\n  register({\n    name: 'undo',\n    keyboard: 'ctrl+z',\n    execute() {\n      return {\n        redo() {\n          if (state.current === -1) return;\n          const item = state.queue[state.current]; //这里没有操作queue\n          if (item) {\n            item.undo && item.undo();\n            state.current--;\n          }\n        }\n      };\n    }\n  });\n  //还原(下一步)\n  register({\n    name: 'redo',\n    keyboard: 'ctrl+y',\n    execute() {\n      return {\n        redo() {\n          const item = state.queue[state.current + 1];\n          if (item) {\n            item.redo && item.redo();\n            state.current++;\n          }\n        }\n      };\n    }\n  });\n  //拖拽\n  register({\n    name: 'drag',\n    pushQueue: true, //标识可以放进state.queue中\n    init() {\n      //初始化操作\n      this.before = null;\n      //拖拽开始记录初始状态\n      const start = () => (this.before = deepcopy(data.value.blocks));\n      //拖拽结束记录当前状态\n      const end = () => state.commands.drag();\n\n      events.on('start', start);\n      events.on('end', end);\n      //返回销毁函数\n      return () => {\n        events.off('start');\n        events.off('end');\n      };\n    },\n    execute() {\n      //state.commands.drag()\n      const before = this.before;\n      const after = data.value.blocks;\n      return {\n        undo() {\n          data.value = { ...data.value, blocks: before }; //后退\n        },\n        redo() {\n          data.value = { ...data.value, blocks: after }; //前进\n        }\n      };\n    }\n  });\n  //导入更新容器\n  register({\n    name: 'updateContainer',\n    pushQueue: true,\n    execute(newVal) {\n      const before = data.value;\n      const after = newVal;\n      return {\n        //上一步\n        undo() {\n          data.value = before;\n        },\n        //下一步\n        redo() {\n          data.value = after;\n        }\n      };\n    }\n  });\n  //导入更新block\n  register({\n    name: 'updateBlock',\n    pushQueue: true,\n    execute(newVal, oldBlock) {\n      const before = deepcopy(data.value.blocks);\n      const after = (() => {\n        const blocks = [...data.value.blocks];\n        const idx = blocks.indexOf(oldBlock);\n        if (idx > -1) {\n          blocks.splice(idx, 1, newVal);\n        }\n        return blocks;\n      })();\n\n      return {\n        //上一步\n        undo() {\n          data.value = { ...data.value, blocks: before };\n        },\n        //下一步\n        redo() {\n          data.value = { ...data.value, blocks: after };\n        }\n      };\n    }\n  });\n  //置顶:找出未获得焦点的block中zIndex最大的值\n  register({\n    name: 'placeTop',\n    pushQueue: true,\n    execute() {\n      let { focused, unfocused } = focusData.value;\n      const before = deepcopy(data.value.blocks);\n      const after = (() => {\n        let maxZIndex = unfocused.reduce((prev, block) => {\n          return Math.max(prev, block.zIndex);\n        }, -Infinity);\n        focused.forEach(block => (block.zIndex = maxZIndex + 1));\n\n        return data.value.blocks;\n      })();\n\n      return {\n        undo() {\n          data.value = { ...data.value, blocks: before };\n        },\n        redo() {\n          data.value = { ...data.value, blocks: after };\n        }\n      };\n    }\n  });\n  //置底:找出未获得焦点的block中zIndex最小的值；如果minZIndex小于0，将未获得焦点的blocks的index提高\n  register({\n    name: 'placeBottom',\n    pushQueue: true,\n    execute() {\n      let { focused, unfocused } = focusData.value;\n      const before = deepcopy(data.value.blocks);\n      const after = (() => {\n        let minZIndex =\n          unfocused.reduce((prev, block) => {\n            return Math.min(prev, block.zIndex);\n          }, Infinity) - 1;\n\n        if (minZIndex < 0) {\n          const dur = Math.abs(minZIndex);\n          minZIndex = 0;\n          unfocused.forEach(block => (block.zIndex += dur));\n        }\n        focused.forEach(block => (block.zIndex = minZIndex));\n\n        return data.value.blocks;\n      })();\n\n      return {\n        undo() {\n          data.value = { ...data.value, blocks: before };\n        },\n        redo() {\n          data.value = { ...data.value, blocks: after };\n        }\n      };\n    }\n  });\n  //删除\n  register({\n    name: 'delete',\n    pushQueue: true,\n    execute() {\n      const before = deepcopy(data.value.blocks);\n      const after = focusData.value.unfocused;\n      return {\n        undo() {\n          data.value = { ...data.value, blocks: before };\n        },\n        redo() {\n          data.value = { ...data.value, blocks: after };\n        }\n      };\n    }\n  });\n\n  const keyboardEvent = (() => {\n    const keyCodes = {\n      89: 'y',\n      90: 'z'\n    };\n    const onkeydown = e => {\n      const { keyCode, ctrlKey } = e;\n      let keyString = [];\n      if (ctrlKey) keyString.push('ctrl');\n      keyString.push(keyCodes[keyCode]);\n      keyString = keyString.join('+'); //ctrl+z   ctrl+yc\n\n      state.commandsArray.forEach(({ keyboard, name }) => {\n        if (!keyboard) return; //无键盘事件\n        if (keyboard === keyString) {\n          state.commands[name]();\n          e.preventDefault();\n        }\n      });\n    };\n    const init = () => {\n      window.addEventListener('keydown', onkeydown);\n      //销毁函数\n      return () => {\n        window.removeEventListener('keydown', onkeydown);\n      };\n    };\n    return init;\n  })();\n\n  (() => {\n    //监听键盘事件\n\n    state.destroyArray.push(keyboardEvent());\n    state.commandsArray.forEach(command => {\n      command.init && state.destroyArray.push(command.init());\n    });\n\n    //清理绑定的事件\n    onUnmounted(() => {\n      state.destroyArray.forEach(fn => fn && fn());\n    });\n  })();\n  return state;\n}\n","import { createVNode, defineComponent, render, reactive } from 'vue';\nimport { ElButton, ElDialog, ElInput } from 'element-plus';\n\nconst DialogComponent = defineComponent({\n  props: {\n    option: Object\n  },\n  setup(props, ctx) {\n    const state = reactive({\n      isShow: false,\n      option: props.option //用户传入的属性\n    });\n\n    ctx.expose({\n      showDialog(option) {\n        state.isShow = true;\n        state.option = option;\n      }\n    });\n\n    const onCancel = () => {\n      state.isShow = false;\n    };\n    const onConfirm = () => {\n      state.isShow = false;\n      state.option.confirm && state.option.confirm(state.option.content);\n    };\n\n    return () => {\n      /* vue3中的插槽都是函数 */\n      return (\n        <ElDialog v-model={state.isShow} title={state.option.title}>\n          {{\n            default: () => (\n              <ElInput\n                type='textarea'\n                rows={10}\n                v-model={state.option.content}\n              />\n            ),\n            footer: () =>\n              state.option.footer && (\n                <div>\n                  <ElButton type='primary' onclick={onConfirm}>\n                    确定\n                  </ElButton>\n                  <ElButton onclick={onCancel}>取消</ElButton>\n                </div>\n              )\n          }}\n        </ElDialog>\n      );\n    };\n  }\n});\n\nlet vm;\nfunction $dialog(option) {\n  if (!vm) {\n    let el = document.createElement('div');\n    vm = createVNode(DialogComponent, { option }); //创建组件的虚拟节点\n    document.body.appendChild((render(vm, el), el)); //render将虚拟节点渲染成真实节点 ，手动挂载组件到元素el上\n  }\n  let { showDialog } = vm.component.exposed;\n  showDialog(option);\n}\n\nexport default $dialog;\n","import {\n  defineComponent,\n  createVNode,\n  render,\n  ref,\n  reactive,\n  computed,\n  onMounted,\n  onBeforeUnmount,\n  provide,\n  inject\n} from 'vue';\n\n/* 下拉项组件 */\nexport const DropdownItem = defineComponent({\n  props: {\n    label: {\n      type: String,\n      required: true\n    },\n    icon: String,\n    handler: {\n      type: Function\n    }\n  },\n  //props无需响应式\n  setup({ icon, label }) {\n    const hide = inject('hideDropdown');\n    return () => {\n      return (\n        <div class='dropdown-item' onClick={hide}>\n          <i class={icon} style='margin-right:5px;' />\n          {label}\n        </div>\n      );\n    };\n  }\n});\n\n/* 下拉组件 */\nconst DropdownComponent = defineComponent({\n  props: {\n    option: { type: Object }\n  },\n  setup(props, ctx) {\n    const dropdownRef = ref(null);\n    const state = reactive({\n      show: false,\n      option: props.option,\n      top: 0,\n      left: 0\n    });\n\n    const style = computed(() => ({\n      left: state.left,\n      top: state.top\n    }));\n\n    ctx.expose({\n      showDropdown(option) {\n        state.option = option;\n        state.show = true;\n        const { clientX, clientY } = state.option.e;\n        state.left = clientX + 10 + 'px';\n        state.top = clientY + 10 + 'px';\n      }\n    });\n\n    provide('hideDropdown', () => {\n      state.show = false;\n    });\n\n    const onMouseDown = e => {\n      if (!dropdownRef.value.contains(e.target)) state.show = false;\n    };\n\n    onMounted(() => {\n      document.addEventListener('mousedown', onMouseDown, true); //捕获\n    });\n    onBeforeUnmount(() => {\n      document.removeEventListener('mousedown', onMouseDown, true);\n    });\n\n    return () => {\n      return (\n        <div\n          class='dropdown'\n          style={style.value}\n          v-show={state.show}\n          ref={dropdownRef}\n        >\n          {props.option.content()}\n        </div>\n      );\n    };\n  }\n});\n\nlet vm;\nconst $dropdown = option => {\n  if (!vm) {\n    const el = document.createElement('div');\n    vm = createVNode(DropdownComponent, { option });\n    document.body.appendChild((render(vm, el), el));\n  }\n  const { showDropdown } = vm.component.exposed;\n  showDropdown(option);\n};\n\nexport default $dropdown;\n","import deepcopy from 'deepcopy';\nimport {\n  ElButton,\n  ElSelect,\n  ElOption,\n  ElForm,\n  ElFormItem,\n  ElInput,\n  ElInputNumber,\n  ElColorPicker\n} from 'element-plus';\nimport { defineComponent, inject, reactive, watch } from 'vue';\n\nexport default defineComponent({\n  props: {\n    block: Object, //最后选中的元素block\n    data: Object,\n    updateContainer: Function,\n    updateBlock: Function\n  },\n  setup(props) {\n    const config = inject('config');\n    const state = reactive({ editData: {} });\n    const reset = () => {\n      if (!props.block) {\n        state.editData = deepcopy(props.data.container);\n      } else {\n        state.editData = deepcopy(props.block);\n      }\n    };\n    const apply = () => {\n      if (!props.block) {\n        //更改容器\n        props.updateContainer({ ...props.data, container: state.editData });\n      } else {\n        //更改block\n        props.updateBlock(state.editData, props.block);\n      }\n    };\n\n    watch(() => props.block, reset, { immediate: true });\n\n    return () => {\n      let content = [];\n      if (!props.block) {\n        content.push(\n          <>\n            <ElFormItem label='容器宽度'>\n              <ElInputNumber v-model={state.editData.width} />\n            </ElFormItem>\n            <ElFormItem label='容器高度'>\n              <ElInputNumber v-model={state.editData.height} />\n            </ElFormItem>\n          </>\n        );\n      } else {\n        const component = config.componentMap[props.block.key]; // { text:{type,..},type,color,size}\n        if (component && component.props) {\n          Object.entries(component.props).map(([propName, propConfig]) => {\n            content.push(\n              <ElFormItem label={propConfig.label}>\n                {{\n                  input: () => (\n                    <ElInput v-model={state.editData.props[propName]} />\n                  ),\n                  color: () => (\n                    <ElColorPicker v-model={state.editData.props[propName]} />\n                  ),\n                  select: () => (\n                    <ElSelect v-model={state.editData.props[propName]}>\n                      {propConfig.options.map(({ value, label }) => (\n                        <ElOption value={value} label={label} />\n                      ))}\n                    </ElSelect>\n                  )\n                }[propConfig.type]()}\n              </ElFormItem>\n            );\n          });\n        }\n\n        if (component && component.model) {\n          //  { default:'label',start:'',end:'' }\n          Object.entries(component.model).map(([modelName, label]) => {\n            content.push(\n              <ElFormItem label={label}>\n                <ElInput v-model={state.editData.model[modelName]} />\n              </ElFormItem>\n            );\n          });\n        }\n      }\n\n      return (\n        <ElForm label-position='top' style='padding:30px'>\n          {content}\n          <ElFormItem>\n            <ElButton type='primary' onclick={apply}>\n              应用\n            </ElButton>\n            <ElButton onclick={reset}>重置</ElButton>\n          </ElFormItem>\n        </ElForm>\n      );\n    };\n  }\n});\n","import { computed, defineComponent, inject, ref } from 'vue';\nimport deepcopy from 'deepcopy';\nimport EditorBlock from './editor-block';\nimport useDrag from '../utils/drag';\nimport useFocus from '../utils/useFocus';\nimport useBlockDrag from '../utils/useBlockDrag';\nimport useCommand from '../utils/useCommand';\nimport $dialog from '../components/Dialog';\nimport $dropdown, { DropdownItem } from '../components/Dropdown';\nimport { ElButton } from 'element-plus';\nimport EditorOperator from './editor-operator';\n\nexport default defineComponent({\n  props: {\n    modelValue: Object,\n    formData: Object\n  },\n  emits: ['update:modelValue'],\n  components: { EditorBlock },\n  setup(props, { emit }) {\n    const containerRef = ref(null);\n    const isPreview = ref(false); // 是否预览模式true  默认false\n    const editorRef = ref(true); // 编辑模式\n    const config = inject('config');\n    const data = computed({\n      get() {\n        return props.modelValue;\n      },\n      set(val) {\n        emit('update:modelValue', deepcopy(val));\n      }\n    });\n    const contentStyle = computed(() => {\n      return {\n        width: data.value.container.width + 'px',\n        height: data.value.container.height + 'px'\n      };\n    });\n\n    //1.物料拖拽\n    const { dragstart, dragend } = useDrag(containerRef, data);\n    //2.组件获取焦点\n    const {\n      blockMouseDown,\n      clearBlockFocus,\n      focusData,\n      lastSelectBlock\n    } = useFocus(data, isPreview, e => blockDrag(e));\n    //3.组件拖拽\n    const { blockDrag, markLine } = useBlockDrag(\n      focusData,\n      lastSelectBlock,\n      data\n    );\n    //4.撤销还原\n    const { commands } = useCommand(data, focusData);\n\n    const onContextMenuBlock = (e, block) => {\n      e.preventDefault();\n      $dropdown({\n        e,\n        el: e.target,\n        content: () => {\n          return (\n            <>\n              <DropdownItem\n                icon='icon-control-top'\n                label='置顶'\n                onclick={() => {\n                  commands.placeTop();\n                }}\n              />\n              <DropdownItem\n                label='置底'\n                icon='icon-control-bottom'\n                onclick={() => {\n                  commands.placeBottom();\n                }}\n              />\n              <DropdownItem\n                icon='icon-yulan'\n                label='查看'\n                onclick={() => {\n                  $dialog({\n                    title: '查看节点数据',\n                    content: JSON.stringify(block)\n                  });\n                }}\n              />\n              <DropdownItem\n                icon='icon-export'\n                label='导入'\n                onclick={() => {\n                  $dialog({\n                    title: '导入节点',\n                    content: '',\n                    footer: true,\n                    confirm(text) {\n                      commands.updateBlock(JSON.parse(text), block);\n                    }\n                  });\n                }}\n              />\n              <DropdownItem\n                label='删除'\n                icon='icon-cangpeitubiao_shanchu'\n                onclick={() => {\n                  commands.delete();\n                }}\n              />\n            </>\n          );\n        }\n      });\n    };\n\n    const buttons = [\n      {\n        label: '撤销',\n        class: 'icon-back',\n        handle: commands.undo\n      },\n      {\n        label: '还原',\n        class: 'icon-back restore',\n        handle: commands.redo\n      },\n      {\n        label: '导入',\n        class: 'icon-import',\n        handle: () => {\n          $dialog({\n            title: '导入json使用',\n            content: '',\n            footer: true,\n            confirm(text) {\n              //data.value = text  //没有撤销还原操作,无法保留历史记录\n              commands.updateContainer(JSON.parse(text));\n            }\n          });\n        }\n      },\n      {\n        label: '导出',\n        class: 'icon-export',\n        handle: () => {\n          $dialog({\n            title: '导出json使用',\n            content: JSON.stringify(data.value)\n          });\n        }\n      },\n      {\n        label: '置顶',\n        class: 'icon-control-top',\n        handle: commands.placeTop\n      },\n      {\n        label: '置底',\n        class: 'icon-control-bottom',\n        handle: commands.placeBottom\n      },\n      {\n        label: '删除',\n        class: 'icon-cangpeitubiao_shanchu',\n        handle: commands.delete\n      },\n      {\n        label: () => (isPreview.value ? '编辑' : '预览'),\n        class: () => (isPreview.value ? 'icon-yulan' : 'icon-bianji'),\n        handle: () => {\n          isPreview.value = !isPreview.value;\n          clearBlockFocus();\n        }\n      },\n      {\n        label: '关闭',\n        class: 'icon-guanbi',\n        handle: () => {\n          editorRef.value = false;\n          clearBlockFocus();\n        }\n      }\n    ];\n\n    return () =>\n      !editorRef.value ? (\n        <div class='editor'>\n          <ElButton\n            type='primary'\n            style='position:absolute;left:10px;top:30px;'\n            onclick={() => {\n              editorRef.value = true;\n            }}\n          >\n            返回编辑\n          </ElButton>\n          {JSON.stringify(props.formData)}\n          <main>\n            {/* 产生滚动条 */}\n            <div class='editor-canvas'>\n              <div class='editor-canvas__content' style={contentStyle.value}>\n                {data.value.blocks.map(block => (\n                  <EditorBlock block={block} formData={props.formData} />\n                ))}\n              </div>\n            </div>\n          </main>\n        </div>\n      ) : (\n        <div class='editor'>\n          <header>\n            {buttons.map(btn => {\n              const label =\n                typeof btn.label === 'function' ? btn.label() : btn.label;\n              const className =\n                typeof btn.class === 'function' ? btn.class() : btn.class;\n              return (\n                <div class='editor-btns' onclick={btn.handle}>\n                  {label}\n                  <i title={label} class={[className]} />\n                </div>\n              );\n            })}\n          </header>\n          <aside>\n            {config.componentList.map(component => (\n              <div\n                class='editor-item shade-mask'\n                draggable\n                ondragstart={e => {\n                  dragstart(e, component);\n                }}\n                ondragend={dragend}\n              >\n                <span class='editor-item-label'>{component.label}</span>\n                {component.preview()}\n              </div>\n            ))}\n          </aside>\n          <section>\n            <EditorOperator\n              block={lastSelectBlock.value}\n              data={data.value}\n              updateContainer={commands.updateContainer}\n              updateBlock={commands.updateBlock}\n            />\n          </section>\n          <main>\n            {/* 产生滚动条 */}\n            <div class='editor-canvas'>\n              <div\n                class='editor-canvas__content'\n                style={contentStyle.value}\n                ref={containerRef}\n                onmousedown={e => clearBlockFocus()}\n              >\n                {data.value.blocks.map((block, index) => (\n                  <EditorBlock\n                    class={[\n                      block.focus ? 'editor-block-focus' : '',\n                      !isPreview.value ? 'shade-mask' : ''\n                    ]}\n                    block={block}\n                    onmousedown={e => blockMouseDown(e, block, index)}\n                    oncontextmenu={e => {\n                      onContextMenuBlock(e, block);\n                    }}\n                    formData={props.formData}\n                  />\n                ))}\n\n                {markLine.x !== null && (\n                  <div\n                    class='mark-line-x'\n                    style={{ left: markLine.x + 'px' }}\n                  />\n                )}\n                {markLine.y !== null && (\n                  <div class='mark-line-y' style={{ top: markLine.y + 'px' }} />\n                )}\n              </div>\n            </div>\n          </main>\n        </div>\n      );\n  }\n});\n","import { ElInput } from 'element-plus';\nimport { defineComponent, computed } from 'vue';\n\nexport default defineComponent({\n  props: {\n    start: String | Number,\n    end: String | Number\n  },\n  emits: ['update:start', 'update:end'],\n  setup(props, ctx) {\n    const start = computed({\n      get() {\n        return props.start;\n      },\n      set(val) {\n        ctx.emit('update:start', val);\n      }\n    });\n    const end = computed({\n      get() {\n        return props.end;\n      },\n      set(val) {\n        ctx.emit('update:end', val);\n      }\n    });\n\n    return () => (\n      <div class='my-range'>\n        <ElInput type='text' v-model={start.value} /> -{' '}\n        <ElInput type='text' v-model={end.value} />\n      </div>\n    );\n  }\n});\n","import { ElButton, ElInput, ElSelect } from 'element-plus';\nimport Range from '../components/Range';\n\nfunction createEditorConfig() {\n  let componentList = []; //用来渲染左侧预览图\n  let componentMap = {}; //key 和 component映射，根据key渲染component\n  return {\n    componentList,\n    componentMap,\n    register(component) {\n      if (!componentMap[component.key]) {\n        componentMap[component.key] = component;\n        componentList.push(component);\n      }\n    }\n  };\n}\n\nlet registerConfig = createEditorConfig();\n\nconst createInputProp = label => {\n  return { type: 'input', label };\n};\nconst createColorProp = label => {\n  return { type: 'color', label };\n};\nconst createSelectProp = (label, options) => {\n  return { type: 'select', label, options };\n};\n\nregisterConfig.register({\n  key: 'text',\n  label: '文本',\n  preview: () => '预览文本',\n  render: ({ props }) => (\n    <span style={{ color: props.color, fontSize: props.size }}>\n      {props.text || '渲染文本'}\n    </span>\n  ),\n  props: {\n    text: createInputProp('文本内容'),\n    color: createColorProp('字体颜色'),\n    size: createSelectProp('字体大小', [\n      { value: '14px', label: '14px' },\n      { value: '16px', label: '16px' },\n      { value: '20px', label: '20px' }\n    ])\n  }\n});\n\nregisterConfig.register({\n  key: 'button',\n  label: '按钮',\n  preview: () => <ElButton>按钮</ElButton>,\n  render: ({ props }) => (\n    <ElButton type={props.type} size={props.size}>\n      {props.text || '我的按钮'}\n    </ElButton>\n  ),\n  props: {\n    text: createInputProp('文本内容'),\n    type: createSelectProp('按钮类型', [\n      { value: 'primary', label: '基础' },\n      { value: 'success', label: '成功' },\n      { value: 'warning', label: '警告' },\n      { value: 'danger', label: '危险' },\n      { value: 'text', label: '文本' }\n    ]),\n    size: createSelectProp('按钮尺寸', [\n      { value: 'medium', label: '中等' },\n      { value: 'small', label: '小' },\n      { value: 'mini', label: '极小' }\n    ])\n  }\n});\n\nregisterConfig.register({\n  key: 'input',\n  label: '输入框',\n  preview: () => <ElInput placeholder='请输入' />,\n  render: ({ model }) => <ElInput {...model.default} placeholder='请输入' />,\n  model: {\n    default: '绑定字段名'\n  }\n});\n\n/* registerConfig.register({\n  key: 'select',\n  label: '下拉框',\n  preview: () => <ElSelect modelValue=''></ElSelect>,\n  render: ({ props }) => <ElSelect modelValue=''></ElSelect>,\n  props: {}\n}); */\n\nregisterConfig.register({\n  key: 'range',\n  label: '范围输入框',\n  preview: () => <Range />,\n  render: ({ model }) => (\n    <Range\n      start={model.start.modelValue}\n      end={model.end.modelValue}\n      onUpdate:start={model.start['onUpdate:modelValue']}\n      onUpdate:end={model.end['onUpdate:modelValue']}\n    />\n  ),\n  model: {\n    start: '开始字段名',\n    end: '结束字段名'\n  }\n});\n\nexport default registerConfig;\n","import { render } from \"./App.vue?vue&type=template&id=de67c88c\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/home/travis/build/Cmingqiu/lowcode_vue3/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { createApp } from 'vue';\nimport App from './App.vue';\nimport 'element-plus/lib/theme-chalk/index.css';\n// import ElementPlus from 'element-plus';\nimport './style/index.scss';\n\ncreateApp(App)\n  // .use(ElementPlus)\n  .mount('#app');\n"],"sourceRoot":""}